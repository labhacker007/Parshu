# Application - Environment Variables Example
# Copy this to .env and customize for your local environment

# =============================================================================
# Database Configuration
# =============================================================================
# PostgreSQL connection (REQUIRED)
POSTGRES_USER=huntsphere_user
POSTGRES_PASSWORD=  # REQUIRED: Generate strong password (20+ characters)
POSTGRES_DB=huntsphere_db
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@localhost:5432/${POSTGRES_DB}

# Redis (for rate limiting and caching) (REQUIRED)
REDIS_URL=redis://localhost:6379/0

# =============================================================================
# Security Configuration - CRITICAL!
# =============================================================================
# JWT Secret Key (REQUIRED)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# MUST be 32+ characters, randomly generated
SECRET_KEY=  # REQUIRED: NEVER use default value

JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=1  # Reduced to 1 hour for security
REFRESH_TOKEN_EXPIRATION_DAYS=7

# =============================================================================
# Initial Admin User - REQUIRED for first-time setup
# =============================================================================
# Password must be at least 12 characters
ADMIN_PASSWORD=
# Email for admin user (optional, defaults to admin@localhost)
ADMIN_EMAIL=admin@localhost

# CORS
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# Application
APP_NAME=HuntSphere
APP_VERSION=1.0.0
DEBUG=true

# =============================================================================
# GenAI Configuration - Choose your AI provider
# =============================================================================

# Active Provider: openai, anthropic, gemini, or ollama
GENAI_PROVIDER=ollama

# --- Ollama (Local - Recommended for Testing) ---
# No API key needed! Just install and run: brew install ollama && ollama serve
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama3.1:8b
# Alternative models: mistral, codellama, llama2

# --- OpenAI ---
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4-turbo-preview

# --- Anthropic Claude ---
ANTHROPIC_API_KEY=
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# --- Google Gemini ---
GEMINI_API_KEY=
GEMINI_MODEL=gemini-1.5-pro

# Hunt Platform Connectors
# Palo Alto XSIAM
XSIAM_API_KEY=
XSIAM_BASE_URL=https://api-yourinstance.xdr.us.paloaltonetworks.com

# Microsoft Defender
DEFENDER_TENANT_ID=
DEFENDER_CLIENT_ID=
DEFENDER_CLIENT_SECRET=

# Wiz Cloud Security
WIZ_API_KEY=
WIZ_BASE_URL=https://api.wiz.io

# Splunk
SPLUNK_HOST=
SPLUNK_TOKEN=
SPLUNK_PORT=8089

# VirusTotal
VIRUSTOTAL_API_KEY=

# VMRay
VMRAY_API_KEY=
VMRAY_BASE_URL=https://cloud.vmray.com/api/v1

# Notifications
# Slack
SLACK_WEBHOOK_URL=
SLACK_BOT_TOKEN=

# Email (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=huntsphere@yourdomain.com

# ServiceNow
SERVICENOW_INSTANCE=
SERVICENOW_USERNAME=
SERVICENOW_PASSWORD=

# SAML/SSO Configuration
SAML_ENABLED=false
SAML_IDP_ENTITY_ID=
SAML_IDP_SSO_URL=
SAML_IDP_SLO_URL=
SAML_IDP_CERT=
SAML_SP_ENTITY_ID=http://localhost:8000/saml
SAML_SP_ACS_URL=http://localhost:8000/saml/acs

# Automation Settings
ENABLE_AUTOMATION_SCHEDULER=true
FEED_CHECK_INTERVAL_MINUTES=30
AUTO_EXTRACT_INTELLIGENCE=true
AUTO_HUNT_ENABLED=false

# Data Retention (days)
ARTICLE_RETENTION_DAYS=365
AUDIT_LOG_RETENTION_DAYS=90
HUNT_RESULT_RETENTION_DAYS=180

# Rate Limiting
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_SECONDS=60
